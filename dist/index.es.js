import e,{createContext as o,useRef as t,useEffect as r,useCallback as n,useContext as i,useState as l}from"react";const c=o(null);function u({flow:e="implicit",scope:o="",onSuccess:l,onError:u,onNonOAuthError:s,overrideScope:a,state:d,...v}){const{clientId:p,scriptLoadedSuccessfully:h}=function(){const e=i(c);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}(),m=t(),w=t(l);w.current=l;const g=t(u);g.current=u;const f=t(s);f.current=s,r((()=>{var t,r;if(!h)return;const n="implicit"===e?"initTokenClient":"initCodeClient",i=null===(r=null===(t=null===window||void 0===window?void 0:window.google)||void 0===t?void 0:t.accounts)||void 0===r?void 0:r.oauth2[n]({client_id:p,scope:a?o:`openid profile email ${o}`,callback:e=>{var o,t;if(e.error)return null===(o=g.current)||void 0===o?void 0:o.call(g,e);null===(t=w.current)||void 0===t||t.call(w,e)},error_callback:e=>{var o;null===(o=f.current)||void 0===o||o.call(f,e)},state:d,...v});m.current=i}),[p,h,e,o,d]);const E=n((e=>{var o;return null===(o=m.current)||void 0===o?void 0:o.requestAccessToken(e)}),[]),k=n((()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.requestCode()}),[]);return"implicit"===e?E:k}var s;void 0===s&&(s={}),s.insertAt;const a=()=>{const[o,t]=l(""),[n,i]=l([]),c=u({onSuccess:e=>{console.log(e)},flow:"auth-code",scope:"https://www.googleapis.com/auth/drive"});r((()=>{o&&s()}),[o]);const s=async()=>{try{const e=await fetch("https://www.googleapis.com/drive/v3/files",{headers:{Authorization:`Bearer ${o}`}}),t=await e.json();i(t.files)}catch(e){console.error("Error fetching files: ",e)}};return e.createElement(GoogleOAuthProvider,{clientId:"375499242890-r9i0i6cli22p4f5q0cv8dss48k4od2s1.apps.googleusercontent.com"},e.createElement("h2",null,"React Google Drive Integration"),e.createElement("button",{onClick:()=>c()},"Sign in with Google ðŸš€"),n.length>0&&e.createElement("div",null,e.createElement("h3",null,"Files:"),e.createElement("ul",null,n.map((o=>e.createElement("li",{key:o.id},o.name))))))};export{a as GoogleDrive};
