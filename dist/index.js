"use strict";var e=require("react");const t=e.createContext(null);function o({clientId:o,nonce:r,onScriptLoadSuccess:n,onScriptLoadError:c,children:l}){const i=function(t={}){const{nonce:o,onScriptLoadSuccess:r,onScriptLoadError:n}=t,[c,l]=e.useState(!1),i=e.useRef(r);i.current=r;const u=e.useRef(n);return u.current=n,e.useEffect((()=>{const e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=o,e.onload=()=>{var e;l(!0),null===(e=i.current)||void 0===e||e.call(i)},e.onerror=()=>{var e;l(!1),null===(e=u.current)||void 0===e||e.call(u)},document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[o]),c}({nonce:r,onScriptLoadSuccess:n,onScriptLoadError:c}),u=e.useMemo((()=>({clientId:o,scriptLoadedSuccessfully:i})),[o,i]);return e.createElement(t.Provider,{value:u},l)}function r({flow:o="implicit",scope:r="",onSuccess:n,onError:c,onNonOAuthError:l,overrideScope:i,state:u,...s}){const{clientId:a,scriptLoadedSuccessfully:d}=function(){const o=e.useContext(t);if(!o)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return o}(),v=e.useRef(),f=e.useRef(n);f.current=n;const p=e.useRef(c);p.current=c;const m=e.useRef(l);m.current=l,e.useEffect((()=>{var e,t;if(!d)return;const n="implicit"===o?"initTokenClient":"initCodeClient",c=null===(t=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===t?void 0:t.oauth2[n]({client_id:a,scope:i?r:`openid profile email ${r}`,callback:e=>{var t,o;if(e.error)return null===(t=p.current)||void 0===t?void 0:t.call(p,e);null===(o=f.current)||void 0===o||o.call(f,e)},error_callback:e=>{var t;null===(t=m.current)||void 0===t||t.call(m,e)},state:u,...s});v.current=c}),[a,d,o,r,u]);const h=e.useCallback((e=>{var t;return null===(t=v.current)||void 0===t?void 0:t.requestAccessToken(e)}),[]),g=e.useCallback((()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.requestCode()}),[]);return"implicit"===o?h:g}const n=()=>(r({onSuccess:e=>{console.log(e)},flow:"auth-code",scope:"https://www.googleapis.com/auth/drive"}),e.createElement("button",null,"Login"));var c;void 0===c&&(c={}),c.insertAt;exports.GoogleDrive=()=>{const[t,r]=e.useState(""),[c,l]=e.useState([]);e.useEffect((()=>{t&&i()}),[t]);const i=async()=>{try{const e=await fetch("https://www.googleapis.com/drive/v3/files",{headers:{Authorization:`Bearer ${t}`}}),o=await e.json();l(o.files)}catch(e){console.error("Error fetching files: ",e)}};return e.createElement(o,{clientId:"375499242890-r9i0i6cli22p4f5q0cv8dss48k4od2s1.apps.googleusercontent.com"},e.createElement("h2",null,"React Google Drive Integration"),e.createElement(n,null),c.length>0&&e.createElement("div",null,e.createElement("h3",null,"Files:"),e.createElement("ul",null,c.map((t=>e.createElement("li",{key:t.id},t.name))))))};
